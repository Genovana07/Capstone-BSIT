{% extends "client-base.html" %}
{% block title %}Checklist Details{% endblock %}

{% block content %}
<div class="checklist-detail-container">
    <h2>Checklist for "{{ booking.package.title }}"</h2>
    <p><strong>Customer:</strong> {{ booking.full_name }}</p>
    <p><strong>Event Date:</strong> {{ booking.event_date|date:"M d, Y" }}</p>

    <form id="checklistForm" method="post">
        {% csrf_token %}
        <div class="table-wrapper">
            <table class="styled-table">
                <thead>
                    <tr>
                        <th>Equipment</th>
                        <th>Required</th>
                        <th>Received</th>
                        <th>Confirm</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in checklist.items.all %}
                    <tr>
                        <td>{{ item.equipment.name }}</td>
                        <td>{{ item.quantity_required }}</td>
                        <td>
                            <input type="number" name="received_{{ item.id }}" value="{{ item.quantity_received }}" min="0" max="{{ item.quantity_required }}" class="input-number">
                        </td>
                        <td>
                            <input type="checkbox" name="confirm_{{ item.id }}" {% if item.confirmed %}checked{% endif %} class="checkbox-confirm">
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="no-data">No equipment in this checklist.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <button type="button" id="saveBtn" class="btn-save">ðŸ’¾ Save Checklist</button>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
document.getElementById('saveBtn').addEventListener('click', function(e){
    Swal.fire({
        title: 'Save Checklist?',
        text: "Are you sure you want to save the checklist?",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#28a745',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, save it!'
    }).then((result) => {
        if (result.isConfirmed) {
            document.getElementById('checklistForm').submit();
        }
    });
});
</script>

<style>
/* ðŸŒž Light Mode */
.checklist-detail-container {
    margin: 30px 0;
}

.checklist-detail-container h2 {
    font-size: 24px;
    margin-bottom: 8px;
    color: #333;
}

.checklist-detail-container p {
    margin: 2px 0 12px;
    color: #555;
}

/* Table Wrapper */
.table-wrapper {
    overflow-x: auto;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin-bottom: 15px;
}

/* Styled Table */
.styled-table {
    width: 100%;
    border-collapse: collapse;
    background: #fff;
    border-radius: 12px;
    overflow: hidden;
}

.styled-table th,
.styled-table td {
    padding: 12px 16px;
    text-align: left;
    transition: background 0.3s ease, color 0.3s ease;
}

.styled-table thead {
    background: #f5f5f5;
}

.styled-table th {
    font-weight: 600;
    border-bottom: 2px solid #ddd;
}

.styled-table tbody tr:nth-child(even) {
    background-color: #fafafa;
}

.styled-table tbody tr:hover {
    background-color: #e6f2ff;
}

/* Input Styles */
.input-number {
    width: 60px;
    padding: 4px 6px;
    border-radius: 6px;
    border: 1px solid #ccc;
    text-align: center;
}

.checkbox-confirm {
    width: 18px;
    height: 18px;
}

/* Button */
.btn-save {
    padding: 8px 20px;
    background-color: #28a745;
    color: white;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.3s ease;
}
.btn-save:hover {
    background-color: #1e7e34;
}

/* No Data Row */
.no-data {
    text-align: center;
    font-style: italic;
    color: #888;
}

/* ðŸŒ™ Dark Mode */
body.dark-mode .checklist-detail-container h2,
body.dark-mode .checklist-detail-container p {
    color: #e0e0e0;
}

body.dark-mode .styled-table {
    background: #2c2f38;
    color: #e0e0e0;
}

body.dark-mode .styled-table thead {
    background: #333;
}

body.dark-mode .styled-table th {
    border-bottom: 2px solid #444;
    color: #f0f0f0;
}

body.dark-mode .styled-table tbody tr:nth-child(even) {
    background-color: #3a3d46;
}

body.dark-mode .styled-table tbody tr:hover {
    background-color: #50535c;
}

body.dark-mode .input-number {
    border: 1px solid #555;
    background: #3a3d46;
    color: #e0e0e0;
}

body.dark-mode .btn-save {
    background-color: #1e7e34;
}
body.dark-mode .btn-save:hover {
    background-color: #145a24;
}

body.dark-mode .no-data {
    color: #bbb;
}
</style>
{% endblock %}
