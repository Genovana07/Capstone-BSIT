{% extends 'client-base.html' %}
{% block title %}Admin Access Requests{% endblock %}
{% block content %}

<style>
/* üåû LIGHT MODE */
.admin-requests-container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 2rem;
}

.admin-requests-container h2 {
    font-size: 2rem;
    font-weight: 800;
    color: #1f2937;
    margin-bottom: 1.5rem;
}

.admin-note {
    background: linear-gradient(to right, #fef9c3, #fde68a);
    border-left: 6px solid #f59e0b;
    padding: 1rem 1.25rem;
    border-radius: 12px;
    font-size: 0.95rem;
    color: #6b7280;
    margin-bottom: 2rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
}

.admin-requests-list {
    display: grid;
    gap: 1.5rem;
}

.admin-request-card {
    background: #ffffff;
    border-radius: 16px;
    padding: 1.5rem;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    border-left: 6px solid #3b82f6;
    transition: all 0.3s ease;
}

.admin-request-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.12);
}

.admin-request-details p {
    margin: 0.2rem 0;
    font-size: 0.9rem;
    color: #374151;
}

.admin-request-details p strong {
    color: #111827;
}

.approve-btn {
    background: linear-gradient(to right, #6366f1, #ec4899, #f43f5e);
    padding: 0.75rem 2rem;
    border: none;
    border-radius: 12px;
    font-weight: 700;
    color: white;
    font-size: 1rem;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(0,0,0,0.15);
    transition: all 0.3s ease;
}

.approve-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 20px rgba(0,0,0,0.2);
}

/* üåô DARK MODE */
body.dark-mode .admin-requests-container h2 {
    color: #f3f4f6;
}

body.dark-mode .admin-note {
    background: linear-gradient(to right, #facc15, #fbbf24);
    color: #1f2937;
    box-shadow: 0 4px 10px rgba(255,255,255,0.05);
}

body.dark-mode .admin-request-card {
    background: #1f2937;
    color: #e5e7eb;
    box-shadow: 0 4px 12px rgba(255,255,255,0.08);
    border-left-color: #60a5fa;
}

body.dark-mode .admin-request-details p {
    color: #d1d5db;
}

body.dark-mode .approve-btn {
    background: linear-gradient(to right, #10b981, #34d399, #059669);
    color: white;
}
</style>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<div class="admin-requests-container">
    <h2>‚ö° Admin Access Requests</h2>

    <div class="admin-note">
        üîë <strong>Note:</strong> Only users with usernames containing 
        <code class="bg-gray-200 px-2 py-1 rounded">staff</code> and not yet admins 
        will appear here.
    </div>

    {% if requested_profiles %}
        <div class="admin-requests-list">
            {% for profile in requested_profiles %}
                <div class="admin-request-card">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
                        <div class="admin-request-details">
                            <p><strong>üë§ Name:</strong> {{ profile.user.get_full_name|default:"(No Name)" }}</p>
                            <p><strong>Username:</strong> {{ profile.user.username }}</p>
                            <p><strong>Email:</strong> {{ profile.user.email }}</p>
                            <p><strong>Phone:</strong> {{ profile.contact_number }}</p>
                            <p><strong>Address:</strong> {{ profile.address|default:"N/A" }}</p>
                            <p><strong>Province:</strong> {{ profile.province }}</p>
                            <p><strong>City:</strong> {{ profile.city }}</p>
                        </div>

                        <form method="POST" action="{% url 'approve_admin' profile.user.id %}" 
                              onsubmit="return confirmApprove(event, '{{ profile.user.username }}')">
                            {% csrf_token %}
                            <button type="submit" class="approve-btn">
                                üõ°Ô∏è Approve Admin
                            </button>
                        </form>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-gray-500 text-lg mt-6 text-center italic">No valid admin requests at the moment.</p>
    {% endif %}
</div>

<script>
function confirmApprove(event, username) {
    event.preventDefault();
    Swal.fire({
        title: 'Approve Admin?',
        text: "Are you sure you want to approve '" + username + "' as an admin?",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#10b981',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, approve'
    }).then((result) => {
        if (result.isConfirmed) {
            event.target.submit();
        }
    });
}
</script>

{% endblock %}
