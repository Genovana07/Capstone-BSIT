{% extends 'base.html' %}
{% load static %}

{% block title %}Home{% endblock %}

{% block content %}
<main class="main-section">
    <h2 class="tagline">Rent. <span>Set the Mood.</span></h2>
    <h1 class="main-heading">Make the Magic Happen.</h1>
    <p class="description">StudioFlow provides top-quality sound and lighting equipment for any event, big or small.</p>

    <a href="{% url 'services' %}">
        <button class="book-now">BOOK NOW</button>
    </a>
</main>

<div class="container highlights">
    <div class="header">
        <span>Event Highlights</span>
    </div>

    <div class="gallery">
        <div class="item">
            <img src="{% static 'images/highlight1.jpg' %}" 
                 alt="Highlight 1" 
                 onclick="openLightbox(this.src)" 
                 style="cursor: zoom-in;">
            <p>Grand Opening Night</p>
        </div>

        <div class="item">
            <img src="{% static 'images/highlight2.jpg' %}" 
                 alt="Highlight 2" 
                 onclick="openLightbox(this.src)" 
                 style="cursor: zoom-in;">
            <p>Stage Performance</p>
        </div>

        <div class="item">
            <img src="{% static 'images/highlight3.jpg' %}" 
                 alt="Highlight 3" 
                 onclick="openLightbox(this.src)" 
                 style="cursor: zoom-in;">
            <p>Audience Engagement</p>
        </div>

        <div class="item">
            <img src="{% static 'images/highlight4.jpg' %}" 
                 alt="Highlight 4" 
                 onclick="openLightbox(this.src)" 
                 style="cursor: zoom-in;">
            <p>Special Guests</p>
        </div>
    </div>

    <button onclick="scrollToContainer1()" class="see-more-btn">
        See More
    </button>
</div>


<!-- Hidden Additional Gallery -->
<div id="container1" class="container1" style="display: none;">
    <div class="title-container">
        <h2 class="title">More Event Highlights</h2>
    </div>
    <div class="video-section">
        <video src="{% static 'video/video1.mp4' %}" controls autoplay muted></video>
    </div>
    <div class="gallery1">
        <div class="item1">
            <img src="{% static 'images/highlight5.jpg' %}" alt="Highlight 5"
                 onclick="openLightbox(this.src)" style="cursor: zoom-in;">
            <p>Wedding Ceremony</p>
        </div>
        <div class="item1">
            <img src="{% static 'images/highlight6.jpg' %}" alt="Highlight 6"
                 onclick="openLightbox(this.src)" style="cursor: zoom-in;">
            <p>Birthday Celebration</p>
        </div>
        <div class="item1">
            <img src="{% static 'images/highlight7.jpg' %}" alt="Highlight 7"
                 onclick="openLightbox(this.src)" style="cursor: zoom-in;">
            <p>Corporate Event</p>
        </div>
        <div class="item1">
            <img src="{% static 'images/highlight8.jpg' %}" alt="Highlight 8"
                 onclick="openLightbox(this.src)" style="cursor: zoom-in;">
            <p>Music Festival</p>
        </div>
        <div class="item1">
            <img src="{% static 'images/highlight9.jpg' %}" alt="Highlight 9"
                 onclick="openLightbox(this.src)" style="cursor: zoom-in;">
            <p>Charity Gala</p>
        </div>
        <div class="item1">
            <img src="{% static 'images/highlight10.jpg' %}" alt="Highlight 10"
                 onclick="openLightbox(this.src)" style="cursor: zoom-in;">
            <p>Graduation Party</p>
        </div>
        <div class="item1">
            <img src="{% static 'images/highlight11.jpg' %}" alt="Highlight 11"
                 onclick="openLightbox(this.src)" style="cursor: zoom-in;">
            <p>Engagement Night</p>
        </div>
        <div class="item1">
            <img src="{% static 'images/highlight12.jpg' %}" alt="Highlight 12"
                 onclick="openLightbox(this.src)" style="cursor: zoom-in;">
            <p>Anniversary Dinner</p>
        </div>
        <div class="item1">
            <img src="{% static 'images/highlight13.jpg' %}" alt="Highlight 13"
                 onclick="openLightbox(this.src)" style="cursor: zoom-in;">
            <p>Team Building</p>
        </div>
        <div class="item1">
            <img src="{% static 'images/highlight14.jpg' %}" alt="Highlight 14"
                 onclick="openLightbox(this.src)" style="cursor: zoom-in;">
            <p>Holiday Celebration</p>
        </div>
    </div>
</div>
<!-- Testimonials -->
<div class="testimonials-container">
  <h2 class="title">Testimonials <span class="line"></span></h2>
  <div class="carousel">
    <div class="cards" id="testimonial-cards">

      <!-- Group 1: first 3 testimonies -->
      <div class="card-group">
        <div class="card">
          <p>“Booking equipment was super easy and the staff were very helpful. They made our event stress-free!”</p>
          <div class="customer-info">
            <img src="{% static 'images/user1.jpg' %}" alt="Maria Santos">
            <span>Maria Santos</span>
            <span class="rating">⭐ 5.0</span>
          </div>
        </div>
        <div class="card">
          <p>“Great service! The sound system was high quality and delivered on time. Highly recommend!”</p>
          <div class="customer-info">
            <img src="{% static 'images/user2.jpg' %}" alt="James Cruz">
            <span>James Cruz</span>
            <span class="rating">⭐ 4.8</span>
          </div>
        </div>
        <div class="card">
          <p>“I booked lights and speakers for my wedding, and everything went perfectly. Excellent experience!”</p>
          <div class="customer-info">
            <img src="{% static 'images/user3.jpg' %}" alt="Angela Reyes">
            <span>Angela Reyes</span>
            <span class="rating">⭐ 5.0</span>
          </div>
        </div>
      </div>

      <!-- Group 2: next 3 testimonies -->
      <div class="card-group">
        <div class="card">
          <p>“Affordable prices, professional team, and smooth booking process. Will book again!”</p>
          <div class="customer-info">
            <img src="{% static 'images/user4.jpg' %}" alt="Mark Dela Cruz">
            <span>Mark Dela Cruz</span>
            <span class="rating">⭐ 4.9</span>
          </div>
        </div>
        <div class="card">
          <p>“They really went above and beyond to accommodate our event needs. Super satisfied!”</p>
          <div class="customer-info">
            <img src="{% static 'images/user5.jpg' %}" alt="Sofia Lim">
            <span>Sofia Lim</span>
            <span class="rating">⭐ 5.0</span>
          </div>
        </div>
        <div class="card">
          <p>“Fantastic setup and clear sound. Our party was a blast thanks to them! They made everything smooth.”</p>
          <div class="customer-info">
            <img src="{% static 'images/user6.jpg' %}" alt="Carlo Mendoza">
            <span>Carlo Mendoza</span>
            <span class="rating">⭐ 4.8</span>
          </div>
        </div>
      </div>

      <!-- Group 3: last 3 testimonies -->
      <div class="card-group">
        <div class="card">
          <p>“Excellent lights that transformed our venue. Highly satisfied! They make our event unforgettable.”</p>
          <div class="customer-info">
            <img src="{% static 'images/user7.jpg' %}" alt="Liza Gomez">
            <span>Liza Gomez</span>
            <span class="rating">⭐ 5.0</span>
          </div>
        </div>
        <div class="card">
          <p>“Very reliable service, everything was ready before our event started. Their team ensured all setups were perfect.”</p>
          <div class="customer-info">
            <img src="{% static 'images/user8.jpg' %}" alt="Paul Tan">
            <span>Paul Tan</span>
            <span class="rating">⭐ 4.9</span>
          </div>
        </div>
        <div class="card">
          <p>“Hassle-free booking and very friendly staff. Thank you! The setup was perfect and our guests loved the experience.”</p>
          <div class="customer-info">
            <img src="{% static 'images/user9.jpg' %}" alt="Grace Villanueva">
            <span>Grace Villanueva</span>
            <span class="rating">⭐ 5.0</span>
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="dots" id="dots">
    <span class="dot active"></span>
    <span class="dot"></span>
    <span class="dot"></span>
  </div>
</div>

<!-- Improved FAQ Section -->
<div class="faq-container">
  <div class="faq-content">
    <h2 class="title">FAQs <span class="line"></span></h2>
    <h3 class = "question">Got questions? We've got answers.</h3>
    <div class="faq-list">
      <details>
        <summary>What services do you offer?</summary>
        <p>We provide premium sound and lighting equipment rental, setup, and event production services.</p>
      </details>

      <details>
        <summary>How can I book equipment?</summary>
        <p>You can book directly through our online platform or contact our team via email/phone.</p>
      </details>

      <details>
        <summary>Do you provide setup assistance?</summary>
        <p>Yes! Our professional team handles setup and ensures everything runs smoothly for your event.</p>
      </details>

      <details>
        <summary>Can I cancel or reschedule my booking?</summary>
        <p>Yes, bookings can be modified or canceled with prior notice according to our policy.</p>
      </details>

      <details>
        <summary>Do you provide delivery and pickup?</summary>
        <p>Absolutely! We handle delivery and pickup for all rental equipment within the service area.</p>
      </details>

      <details>
        <summary>Are your equipment and services insured?</summary>
        <p>Yes, all our equipment is insured and our team follows safety protocols for every event.</p>
      </details>
    </div>
  </div>

  <div class="faq-image">
    <img src="{% static 'images/faq.png' %}" alt="FAQ Illustration" onclick="openLightbox(this.src)" style="cursor: zoom-in;">
  </div>
</div>

<!-- === CHATBOT TOGGLE SYSTEM === -->

<!-- Toggle Button -->
<div class="chatbot-toggle" id="chatbot-toggle">
    💬
</div>

<!-- Chatbot Container -->
<div class="chatbot-container" id="chatbot">
    <!-- Header -->
    <div class="chatbot-header">
        <h2>Booking Chatbot 🤖</h2>
        <p>Ask about available booking dates easily</p>
    </div>

    <!-- Chat Messages -->
    <div id="chat-box" class="chatbot-messages">
        <div class="chat-placeholder">Start asking a question...</div>
    </div>

    <!-- Input -->
    <div class="chatbot-input">
        <input id="chat-input" 
               type="text" 
               placeholder="Type your question here... (e.g., Available ba ang 2025-08-20?)">
        <button id="send-btn">Send</button>
    </div>

    <!-- Guide -->
    <div class="chatbot-guide">
        <h3>📌 Guide: How to Ask</h3>
        <ul>
            <li>Para mag-check ng date: <b>Available ba ang YYYY-MM-DD?</b></li>
            <li>Halimbawa: <i>"Available ba ang 2025-08-20?"</i></li>
            <li>Kung mali ang format ng date → gagabayan ka ng bot.</li>
        </ul>
    </div>
</div>

<!-- SCRIPT -->

<script>
document.addEventListener("DOMContentLoaded", function () {
    // =========================
    // CHATBOT TOGGLE
    // =========================
    const toggleBtn = document.getElementById("chatbot-toggle");
    const chatbot = document.getElementById("chatbot");
    let isOpen = false;

    if (toggleBtn && chatbot) {
        // Default: hidden
        chatbot.style.display = "none";

        toggleBtn.addEventListener("click", function () {
            if (!isOpen) {
                chatbot.style.display = "flex";
                chatbot.classList.remove("fade-out");
                chatbot.style.animation = "fadeInUp 0.3s ease";
                toggleBtn.textContent = "❌"; // change icon
            } else {
                chatbot.classList.add("fade-out");
                toggleBtn.textContent = "💬"; // change icon back
                setTimeout(() => {
                    chatbot.style.display = "none";
                }, 250);
            }
            isOpen = !isOpen;
        });
    }

    // =========================
    // TESTIMONIALS 
    // =========================
    const cards = document.getElementById("testimonial-cards");
    const dots = document.querySelectorAll(".dot");

    if (cards && dots.length > 0) {
        dots.forEach((dot, index) => {
            dot.addEventListener("click", () => {
                dots.forEach(d => d.classList.remove("active"));
                dot.classList.add("active");

                // Move to the group corresponding to the dot
                const offset = -index * 100; 
                cards.style.transform = `translateX(${offset}%)`;
            });
        });
        // Default: unang dot active
        dots[0].classList.add("active");
    }

    // =========================
    // CHATBOT MESSAGE HANDLER
    // =========================
    const sendBtn = document.getElementById("send-btn");
    const inputField = document.getElementById("chat-input");
    const chatBox = document.getElementById("chat-box");

    function sendMessage() {
        let message = inputField.value.trim();
        if (message === "") return;

        // Add user message
        let userMsg = document.createElement("div");
        userMsg.className = "text-right";
        userMsg.innerHTML = `<span class="inline-block bg-blue-500 text-white px-3 py-2 rounded-lg mb-2">${message}</span>`;
        chatBox.appendChild(userMsg);

        // Scroll down
        chatBox.scrollTop = chatBox.scrollHeight;

        // Clear input
        inputField.value = "";

        // Send to API
        fetch(`/accounts/chatbot-api/?message=${encodeURIComponent(message)}`)
            .then(res => res.json())
            .then(data => {
                let botMsg = document.createElement("div");
                botMsg.className = "text-left";
                botMsg.innerHTML = `<span class="inline-block bg-gray-200 text-gray-800 px-3 py-2 rounded-lg mb-2">${data.response}</span>`;
                chatBox.appendChild(botMsg);
                chatBox.scrollTop = chatBox.scrollHeight;
            });
    }

    if (sendBtn && inputField) {
        sendBtn.addEventListener("click", sendMessage);
        inputField.addEventListener("keypress", function (e) {
            if (e.key === "Enter") sendMessage();
        });
    }

    // =========================
    // LIGHTBOX
    // =========================
    const lightboxModal = document.getElementById("lightbox-modal");
    const lightboxImg = document.getElementById("lightbox-img");

    window.openLightbox = function (src) {
        if (lightboxModal && lightboxImg) {
            lightboxImg.src = src;
            lightboxImg.style.width = "100%";
            lightboxImg.style.height = "auto";
            lightboxModal.style.display = "flex";
        }
    };

    window.closeLightbox = function () {
        if (lightboxModal) {
            lightboxModal.style.display = "none";
        }
    };

    // =========================
    // CAROUSEL (ARROWS)
    // =========================
    const cardsContainer = document.getElementById("testimonial-cards");
    const leftArrow = document.querySelector(".left-arrow");
    const rightArrow = document.querySelector(".right-arrow");

    if (cardsContainer && leftArrow && rightArrow) {
        const scrollAmount = cardsContainer.offsetWidth;

        leftArrow.addEventListener("click", () => {
            cardsContainer.scrollBy({
                left: -scrollAmount,
                behavior: "smooth"
            });
        });

        rightArrow.addEventListener("click", () => {
            cardsContainer.scrollBy({
                left: scrollAmount,
                behavior: "smooth"
            });
        });
    }

}); // END of DOMContentLoaded

// =========================
// OTHER HELPERS
// =========================
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== "") {
        const cookies = document.cookie.split(";");
        for (let cookie of cookies) {
            cookie = cookie.trim();
            if (cookie.substring(0, name.length + 1) === (name + "=")) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

function scrollToContainer1() {
    var container = document.getElementById("container1");
    if (container) {
        container.style.display = "block";
        container.scrollIntoView({ behavior: "smooth" });
    }
}

// =========================
// FADE-IN ON SCROLL
// =========================
document.addEventListener("DOMContentLoaded", function () {
  const fadeElements = document.querySelectorAll(
    ".main-section, .highlights, .testimonials-container, .faq-container, .footer"
  );

  fadeElements.forEach(el => el.classList.add("fade-in"));

  const observer = new IntersectionObserver(
    (entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add("show");
          observer.unobserve(entry.target); // i-once lang animation
        }
      });
    },
    { threshold: 0.1 }
  );

  fadeElements.forEach(el => observer.observe(el));
});
</script>

<link rel="stylesheet" href="{% static 'css/home.css' %}">
{% endblock %}
